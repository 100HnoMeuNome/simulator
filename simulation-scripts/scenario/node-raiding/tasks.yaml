kind: cp.simulator/scenario:1.0.0
objective: Node compromise to get readonly kubelet API access.
startingPoint:
  mode: pod
  podName: ""
  podNamespace: node-raiding
tasks:
  "1":
    hints:
      - text: Have you looked into the the kubelet?
      - text: The kubelet readonly API sits on port 10255.
      - text:
          Get anything directly from the kubelet API, circumventing the Kubernetes
          server API, e.g. curl http://<node-IP>:10255/pods
    sortOrder: 1
    startingPoint:
      mode: pod
      podName: ""
      podNamespace: node-raiding
    summary: "We queried the outdated kublet readonly port to get pod information."
  "2":
    hints:
      - text: You need to fix /var/lib/kubelet/config.yaml.
      - text: readOnly port should be 0.
      - text:
          "'systemctl daemon-reload; systemctl restart kubelet.service' applies
          the config changes."
    sortOrder: 2
    startingPoint:
      asRoot: true
      mode: node
      nodeId: node-0
    summary: "We disabled the readonly port in the kubelet config and restarted the service."
